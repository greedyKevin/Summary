### 定义

Open-Location-Code（plus-code）是google于2014年发布的地理编码系统，用于标识全球任意地方。

### 编码

#### 编码规则

* 首先将地球划以每20度分为18 x 9的网格（AA）
* 每个划分的网格可以继续划分为20 x 20的网格,最多3次（BBCCDD）
* 将划分到第三级的网格（DD）划分为4 x 5的网格（EE）

#### 编码规范

##### 结构

AABBCCDD+EEF

前11位：**奇数**位代表纬度，**偶数**位代表经度，**+** 加号不参与运算，长度大于8需要+号，**最后一位**代表网格位置

##### 网格划分

| 编码长度 | 2（AA） | 4 (BB) | 6 (CC) | 8 (DD)  |  +   |  10 (EE)  |   11 (F)    |
| :------: | :-----: | :----: | :----: | :-----: | :--: | :-------: | :---------: |
| 网格精度 |   20°   |   1°   | 0.05°  | 0.0025° |      | 0.000125° | 0.00003125° |
|   范围   | 2200km  | 110km  | 5.5km  |  275m   |      |    14m    |    3.5m     |

##### 数字编码

|    原数字    |  0   |  1   |  2   |  3   |  4   |  5   |  6   |  7   |  8   |  9   |  10  |  11  |  12  |  13  |  14  |  15  |  16  |  17  |  18  |  19  |
| :----------: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| 编码后的数字 |  2   |  3   |  4   |  5   |  6   |  7   |  8   |  9   |  C   |  F   |  G   |  H   |  J   |  M   |  P   |  Q   |  R   |  V   |  W   |  X   |

##### 网格示例

<table border="2" >
    <tr>
        <th></th>
        <th colspan="4" align="center">经度→</th>
    </tr>
    <tr>
        <td width="10%" rowspan="5">纬度↑</td>
        <td>R</td>
        <td>V</td>
        <td>W</td>
        <td>X</td>
    </tr>
    <tr>
        <td>J</td>
        <td>M</td>
        <td>P</td>
        <td>Q</td>
    </tr>
    <tr>
        <td>C</td>
        <td>F</td>
        <td>G</td>
        <td>H</td>
    </tr>
    <tr>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
    </tr>
    <tr>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
    </tr>

### 计算

#### OLC转经纬度

根据相应网格精度计算出所有纬度的减90，所有纬度的和减180。

##### 例子

```
7PMM28RC+4W, 将OLC两两为一组[7P,MM,28,RC,4W]
第一组
	纬度为：7->5 5 x 20 = 100
	经度为：P->14 14 x 20 = 280
同理第二组
	纬度为：13
	经度为：13
所有相加后
纬度：113.0403125 经度：293.322375 
最终结果：(latitude: 23.0403125, longitude: 113.322375)
```

#### 经纬度转OLC

将纬度加90，经度加180后 乘8000（20^3）将结果进行20进制转换后再进行**数字编码**。如果结果少于5位，用0进行补位。

##### 例子

```
(latitude: 23.04033804, longitude: 113.32230844)
纬度：(23.04033804 + 90) x 8000 = 904322.7  	== [5,13,0,16,2](20进制) 		== [7,M,2,R,4](编码)
经度：(113.32230844 + 180) x 8000 = 2346578.5 	== [14,13,6,8,18](20进制) 	== [P,M,8,C,W] (编码)
结果为：7PMM28+RC4W
```

### 参考资料

https://en.wikipedia.org/wiki/Open_Location_Code

https://www.dcode.fr/open-location-code

https://cvzi.github.io/open-location-code-demo/#nointro

### 源码

https://github.com/google/open-location-code